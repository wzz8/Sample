<UserControl x:Class="Login_Sample.Views.ProjectQueryView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:local="clr-namespace:Login_Sample.Views"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             xmlns:viewModels="clr-namespace:Login_Sample.ViewModels"
             mc:Ignorable="d"
             d:DesignHeight="700" d:DesignWidth="1000"
             d:DataContext="{d:DesignInstance Type=viewModels:ProjectQueryViewModel}">
    <Grid Background="#F5F5F5">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        
        <!-- 模块标题 -->
        <Border Background="#FFFFFF" Grid.Row="0" Height="80" BorderBrush="#E0E0E0" BorderThickness="0,0,0,1">
            <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="20,0,0,0">
                <materialDesign:PackIcon Kind="Search" Width="32" Height="32" Foreground="#3498DB" Margin="0,0,15,0"/>
                <TextBlock Text="项目查询" FontSize="24" FontWeight="Bold" Foreground="#2C3E50"/>
            </StackPanel>
        </Border>
        
        <!-- 模块内容区域 -->
        <Grid Grid.Row="1">
            <Grid.RowDefinitions>
                <RowDefinition/>
                <RowDefinition/>
            </Grid.RowDefinitions>
            <!-- 查询条件区域 -->
            <materialDesign:Card Margin="10" Padding="15">
                <StackPanel>
                    <TextBlock Text="查询条件" FontSize="18" FontWeight="Bold" Foreground="#2C3E50" Margin="0,0,0,15"/>
                    
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="200"/>
                            <ColumnDefinition Width="200"/>
                            <ColumnDefinition Width="200"/>
                            <ColumnDefinition Width="200"/>
                            <ColumnDefinition Width="200"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        
                        <!-- 第一行 -->
                        <StackPanel Grid.Column="0" Margin="0,0,10,10">
                            <TextBlock Text="开始日期" FontWeight="Bold" Margin="0,0,0,5"/>
                            <DatePicker SelectedDate="{Binding StartDate}" materialDesign:HintAssist.Hint="选择开始日期"/>
                        </StackPanel>
                        
                        <StackPanel Grid.Column="1" Margin="0,0,10,10">
                            <TextBlock Text="结束日期" FontWeight="Bold" Margin="0,0,0,5"/>
                            <DatePicker SelectedDate="{Binding EndDate}" materialDesign:HintAssist.Hint="选择结束日期"/>
                        </StackPanel>
                        
                        <StackPanel Grid.Column="2" Margin="0,0,10,10">
                            <TextBlock Text="委托书编号" FontWeight="Bold" Margin="0,0,0,5"/>
                            <TextBox materialDesign:HintAssist.Hint="输入委托书编号" Text="{Binding OrderNumber}"/>
                        </StackPanel>
                        
                        <StackPanel Grid.Column="3" Margin="0,0,10,10">
                            <TextBlock Text="项目名称" FontWeight="Bold" Margin="0,0,0,5"/>
                            <TextBox materialDesign:HintAssist.Hint="输入项目名称" Text="{Binding ProjectName}"/>
                        </StackPanel>
                        
                        <StackPanel Grid.Column="4" Margin="0,0,10,10">
                            <TextBlock Text="项目状态" FontWeight="Bold" Margin="0,0,0,5"/>
                            <ComboBox ItemsSource="{Binding StatusOptions}" SelectedItem="{Binding Status}" materialDesign:HintAssist.Hint="选择项目状态"/>
                        </StackPanel>
                        
                        <StackPanel Grid.Column="5" Orientation="Horizontal" VerticalAlignment="Bottom" Margin="10,0,0,10">
                            <Button Content="查询" Command="{Binding SearchCommand}" Background="#3498DB" Foreground="White" Margin="0,0,10,0"/>
                            <Button Content="重置" Command="{Binding ResetCommand}" Background="#95A5A6" Foreground="White" Margin="0,0,10,0"/>
                            <Button Content="导出" Command="{Binding ExportCommand}" Background="#27AE60" Foreground="White"/>
                        </StackPanel>
                    </Grid>
                </StackPanel>
            </materialDesign:Card>
            
            <!-- 统计信息区域 -->
            <Grid Grid.Row="1" Margin="10,0,10,10">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="300"/>
                </Grid.ColumnDefinitions>
                
                <!-- 左侧：数据列表 -->
                <Border Background="#FFFFFF" Margin="0,0,10,0" CornerRadius="5">
                    <StackPanel>
                        <TextBlock Text="查询结果" FontSize="18" FontWeight="Bold" Foreground="#2C3E50" Margin="15,15,0,15"/>
                        
                        <DataGrid ItemsSource="{Binding MaintenanceItems}" AutoGenerateColumns="False" Margin="10" CanUserAddRows="False" IsReadOnly="True">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="委托书编号" Binding="{Binding WorkOrder.OrderNumber}" Width="120"/>
                                <DataGridTextColumn Header="客户名称" Binding="{Binding WorkOrder.Customer.Name}" Width="100"/>
                                <DataGridTextColumn Header="车牌号码" Binding="{Binding WorkOrder.Vehicle.LicensePlate}" Width="100"/>
                                <DataGridTextColumn Header="接待日期" Binding="{Binding WorkOrder.ReceptionDate, StringFormat=yyyy-MM-dd}" Width="100"/>
                                <DataGridTextColumn Header="项目名称" Binding="{Binding ItemName}" Width="150"/>
                                <DataGridTextColumn Header="项目描述" Binding="{Binding Description}" Width="*"/>
                                <DataGridTextColumn Header="单价" Binding="{Binding UnitPrice, StringFormat=C2}" Width="80"/>
                                <DataGridTextColumn Header="数量" Binding="{Binding Quantity}" Width="80"/>
                                <DataGridTextColumn Header="小计" Binding="{Binding Subtotal, StringFormat=C2}" Width="100"/>
                                <DataGridTextColumn Header="技师" Binding="{Binding Technician}" Width="100"/>
                                <DataGridTextColumn Header="项目状态" Binding="{Binding Status}" Width="100"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </StackPanel>
                </Border>
                
                <!-- 右侧：统计信息 -->
                <Border Grid.Column="1" Background="#FFFFFF" Margin="10,0,0,0" CornerRadius="5" VerticalAlignment="Bottom">
                    <StackPanel>
                        <TextBlock Text="统计信息" FontSize="18" FontWeight="Bold" Foreground="#2C3E50" Margin="15,15,0,15"/>
                        
                        <Grid Margin="10">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="100"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <TextBlock Text="统计周期：" FontWeight="Bold" Margin="0,5,0,5" Grid.Row="0" Grid.Column="0"/>
                            <TextBlock Margin="0,5,0,5" Grid.Row="0" Grid.Column="1">
                                <TextBlock.Text>
                                    <MultiBinding StringFormat="{}{0:yyyy-MM-dd} 至 {1:yyyy-MM-dd}">
                                        <Binding Path="StartDate"/>
                                        <Binding Path="EndDate"/>
                                    </MultiBinding>
                                </TextBlock.Text>
                            </TextBlock>
                            
                            <TextBlock Text="项目总数：" FontWeight="Bold" Margin="0,5,0,5" Grid.Row="1" Grid.Column="0"/>
                            <TextBlock Text="{Binding TotalItems}" Margin="0,5,0,5" Grid.Row="1" Grid.Column="1"/>
                            
                            <TextBlock Text="总金额：" FontWeight="Bold" Margin="0,5,0,5" Grid.Row="2" Grid.Column="0"/>
                            <TextBlock Text="{Binding TotalAmount, StringFormat=C2}" Margin="0,5,0,5" Grid.Row="2" Grid.Column="1" FontWeight="Bold" Foreground="#E74C3C"/>
                            
                            <Separator Grid.Row="3" Grid.ColumnSpan="2" Margin="0,10,0,10"/>
                            
                            <TextBlock Text="平均单价：" FontWeight="Bold" Margin="0,5,0,5" Grid.Row="4" Grid.Column="0"/>
                            <TextBlock Text="{Binding TotalAmount, StringFormat=C2}" Margin="0,5,0,5" Grid.Row="4" Grid.Column="1"/>
                        </Grid>
                    </StackPanel>
                </Border>
            </Grid>
        </Grid>
    </Grid>
</UserControl>