<UserControl x:Class="Login_Sample.Views.MaintenanceQueryView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:local="clr-namespace:Login_Sample.Views"
             xmlns:vm="clr-namespace:Login_Sample.ViewModels"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             mc:Ignorable="d"
             d:DesignHeight="450"
             d:DesignWidth="800"
             d:DataContext="{d:DesignInstance Type=vm:MaintenanceQueryViewModel}"
             Background="White">
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- 标题 -->
        <StackPanel Orientation="Horizontal" Margin="0,0,0,20" VerticalAlignment="Center">
            <materialDesign:PackIcon Kind="Search" Width="32" Height="32" Foreground="#3498DB" Margin="0,0,10,0"/>
            <TextBlock Text="维修查询" FontSize="24" FontWeight="Bold" Foreground="#2C3E50"/>
        </StackPanel>

        <!-- 查询条件区域 -->
        <materialDesign:Card x:Name="QueryCard" Grid.Row="0" Margin="0,0,0,20" Background="White">
            <Grid Margin="20">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- 第一行查询条件 -->
                <Grid Grid.Row="0" Margin="0,0,0,15">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="150"/>
                        <ColumnDefinition Width="200"/>
                        <ColumnDefinition Width="150"/>
                        <ColumnDefinition Width="200"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- 状态 -->
                    <TextBlock Text="维修状态:" Grid.Column="0" VerticalAlignment="Center" FontWeight="Medium" Foreground="#2C3E50"/>
                    <ComboBox Grid.Column="1" ItemsSource="{Binding Source={x:Type vm:MaintenanceQueryViewModel+MaintenanceStatus}}" 
                              SelectedItem="{Binding StatusFilter}" 
                              materialDesign:HintAssist.Hint="选择状态"/>

                    <!-- 新用户 -->
                    <TextBlock Text="新用户:" Grid.Column="2" VerticalAlignment="Center" FontWeight="Medium" Foreground="#2C3E50"/>
                    <CheckBox Grid.Column="3" IsChecked="{Binding IsNewUser}" Content="仅显示新用户" VerticalAlignment="Center" Foreground="#2C3E50"/>
                </Grid>

                <!-- 第二行查询条件 -->
                <Grid Grid.Row="1" Margin="0,0,0,15">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="150"/>
                        <ColumnDefinition Width="200"/>
                        <ColumnDefinition Width="150"/>
                        <ColumnDefinition Width="200"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- 分厂 -->
                    <TextBlock Text="维修分厂:" Grid.Column="0" VerticalAlignment="Center" FontWeight="Medium" Foreground="#2C3E50"/>
                    <ComboBox Grid.Column="1" ItemsSource="{Binding FactoryList}" 
                              SelectedItem="{Binding Factory}" 
                              materialDesign:HintAssist.Hint="选择分厂"/>

                    <!-- 类别 -->
                    <TextBlock Text="维修类别:" Grid.Column="2" VerticalAlignment="Center" FontWeight="Medium" Foreground="#2C3E50"/>
                    <ComboBox Grid.Column="3" ItemsSource="{Binding CategoryList}" 
                              SelectedItem="{Binding Category}" 
                              materialDesign:HintAssist.Hint="选择类别"/>
                </Grid>

                <!-- 第三行查询条件 -->
                <Grid Grid.Row="2" Margin="0,0,0,15">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="150"/>
                        <ColumnDefinition Width="200"/>
                        <ColumnDefinition Width="150"/>
                        <ColumnDefinition Width="200"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- 顾问 -->
                    <TextBlock Text="服务顾问:" Grid.Column="0" VerticalAlignment="Center" FontWeight="Medium" Foreground="#2C3E50"/>
                    <ComboBox Grid.Column="1" ItemsSource="{Binding AdvisorList}" 
                              SelectedItem="{Binding Advisor}" 
                              materialDesign:HintAssist.Hint="选择顾问"/>

                    <!-- 关键词搜索 -->
                    <TextBlock Text="关键词:" Grid.Column="2" VerticalAlignment="Center" FontWeight="Medium" Foreground="#2C3E50"/>
                    <TextBox Grid.Column="3" Text="{Binding SearchKeyword}" 
                             materialDesign:HintAssist.Hint="输入维修单号/车牌号/客户姓名"/>
                </Grid>

                <!-- 第四行查询条件 -->
                <Grid Grid.Row="3" Margin="0,0,0,15">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="150"/>
                        <ColumnDefinition Width="200"/>
                        <ColumnDefinition Width="150"/>
                        <ColumnDefinition Width="200"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- 进厂日期 -->
                    <TextBlock Text="进厂日期:" Grid.Column="0" VerticalAlignment="Center" FontWeight="Medium" Foreground="#2C3E50"/>
                    <DatePicker Grid.Column="1" SelectedDate="{Binding StartDate}" 
                                materialDesign:HintAssist.Hint="开始日期"/>

                    <TextBlock Text="至:" Grid.Column="2" VerticalAlignment="Center" FontWeight="Medium" Foreground="#2C3E50" HorizontalAlignment="Center"/>
                    <DatePicker Grid.Column="3" SelectedDate="{Binding EndDate}" 
                                materialDesign:HintAssist.Hint="结束日期"/>
                </Grid>

                <!-- 查询按钮 -->
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,15,0,0">
                    <Button Command="{Binding ResetCommand}" 
                            Margin="0,0,10,0">
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <materialDesign:PackIcon Kind="Refresh" Margin="0,0,4,0"/>
                            <TextBlock Text="重置"/>
                        </StackPanel>
                    </Button>
                    <Button Command="{Binding QueryCommand}" 
                            Background="#3498DB" Foreground="White">
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <materialDesign:PackIcon Kind="Magnify" Margin="0,0,4,0"/>
                            <TextBlock Text="查询"/>
                        </StackPanel>
                    </Button>
                </StackPanel>
            </Grid>
        </materialDesign:Card>

        <!-- 维修记录列表 -->
        <materialDesign:Card x:Name="RecordsCard" Grid.Row="1" Background="White">
            <Grid Margin="20">
                <DataGrid ItemsSource="{Binding MaintenanceRecords}" 
                          AutoGenerateColumns="False" 
                          CanUserAddRows="False" 
                          IsReadOnly="True">
                    <DataGrid.Columns>
                        <!-- 维修单号 -->
                        <DataGridTextColumn Header="维修单号" Binding="{Binding Id}" Width="120"/>
                        <!-- 车牌号 -->
                        <DataGridTextColumn Header="车牌号" Binding="{Binding PlateNumber}" Width="100"/>
                        <!-- 客户姓名 -->
                        <DataGridTextColumn Header="客户姓名" Binding="{Binding CustomerName}" Width="100"/>
                        <!-- 车型 -->
                        <DataGridTextColumn Header="车型" Binding="{Binding VehicleModel}" Width="150"/>
                        <!-- 状态 -->
                        <DataGridTextColumn Header="状态" Binding="{Binding Status}" Width="80"/>
                        <!-- 新用户 -->
                        <DataGridCheckBoxColumn Header="新用户" Binding="{Binding IsNewUser}" Width="80"/>
                        <!-- 分厂 -->
                        <DataGridTextColumn Header="分厂" Binding="{Binding Factory}" Width="80"/>
                        <!-- 类别 -->
                        <DataGridTextColumn Header="类别" Binding="{Binding Category}" Width="100"/>
                        <!-- 顾问 -->
                        <DataGridTextColumn Header="顾问" Binding="{Binding Advisor}" Width="80"/>
                        <!-- 进厂日期 -->
                        <DataGridTextColumn Header="进厂日期" Binding="{Binding EntryDate, StringFormat={}{0:yyyy-MM-dd}}"></DataGridTextColumn>
                        <!-- 出厂日期 -->
                        <DataGridTextColumn Header="出厂日期" Binding="{Binding ExitDate, StringFormat={}{0:yyyy-MM-dd}}"></DataGridTextColumn>
                        <!-- 金额 -->
                        <DataGridTextColumn Header="金额(元)" Binding="{Binding TotalAmount, StringFormat={}{0:N2}}"></DataGridTextColumn>
                        <!-- 描述 -->
                        <DataGridTextColumn Header="维修描述" Binding="{Binding Description}"></DataGridTextColumn>
                    </DataGrid.Columns>
                </DataGrid>
            </Grid>
        </materialDesign:Card>
    </Grid>
</UserControl>
